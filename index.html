<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  </head>
  <body>
    <div class = "sidebar">
     <p>Click the Button to Check In and Out 
     <p>
     <br>
     <input class="action" id="checkinout" type="button" value="" onmouseup="checkingInOut()">
    </div>
     
    <script>
    // Initially Set the button status
    setButtonStatus();
    
    /*Run the getStatus to set the enable/disable property of the Check In and Check Out buttons*/              
    function setButtonStatus() {
       
      var checkedIn = google.script.run.withSuccessHandler(setText).getStatus();
       
      function setText(checkedIn) {
        if (checkedIn) {
          
        // If Checked In, set the button text to 'Check Out'
          document.getElementById("checkinout").value = "Check Out";
         
        } else {
            
        // If Checked Out, set the button text to 'Check In'
        document.getElementById("checkinout").value = "Check In";
         
        }
      } // setText(checkedIn)
    } // setButtonStatus()
     
    function checkingInOut() {
          
      var checkedIn = google.script.run.withSuccessHandler(runCheckInOut).getStatus();

      function runCheckInOut(checkedIn) {
        if (!checkedIn && document.getElementById("checkinout").value === "Check In") {
        
          /* Runs the serverside script checkIn 
          * Then calls the "setButtonStatus" function.
          */
          google.script.run.withSuccessHandler(setButtonStatus).checkIn();
        
        } else if (checkedIn && document.getElementById("checkinout").value === "Check Out"){
        
          /* Runs the serverside script checkIn 
          * Then calls the "setButtonStatus" function.
          */
          google.script.run.withSuccessHandler(setButtonStatus).checkOut();
          
        } else {
        
          //Does not know which function to run
          throw new Error(" Status and Button text incompatible")
          
        }
      } // runCheckInOut(checkedIn)
    }; // checkingInOut()
      
    </script>    
  </body>
</html>